package menaceBienSupport;

import core.RiskAnalysisObject;
import core.asset.Asset;

public class Vulnerability {
  String type = "";
  int Vraissemblance = 0;
  String description ="";
  RiskAnalysisObject cible = null;
  boolean disponibilite = false;
  boolean preuve = false;
  boolean confidentialite = false;
  boolean integrite = false;
  
  
  public String getType() {
	return type;
}


@Override
public boolean equals(Object obj) {
	return (((Vulnerability) obj).getCible().getId().equals(this.getCible().getId()) && ((Vulnerability) obj).getType().equals(this.getType()));
	//return super.equals(obj);
}


public String getDescription() {
	return description;
}


public int getVraissemblance() {
	return Vraissemblance;
}


public RiskAnalysisObject getCible() {
	return cible;
}

public boolean isBesoin(String besoin){
	if (besoin.contentEquals("confidentialite")){return this.isConfidentialite();}
	if (besoin.contentEquals("integrite")){return this.isIntegrite();}
	if (besoin.contentEquals("disponibilite")){return this.isDisponibilite();}
	if (besoin.contentEquals("preuve")){return this.isPreuve();}
	return false;
}

public boolean isDisponibilite() {
	return disponibilite;
}


public boolean isPreuve() {
	return preuve;
}


public boolean isConfidentialite() {
	return confidentialite;
}


public boolean isIntegrite() {
	return integrite;
}

/**
 * 
 * @param type :  type de menace
 * @param vraissemblance : vraissemblance de la menace
 * @param description : description de la menace
 * @param cible : bien support vis√©.
 */
public Vulnerability(String type, int vraissemblance, String description,
		Asset cible) {
	    super();
	   this.type = type;
	   Vraissemblance = vraissemblance;
	   this.description = description;
 	    this.cible = cible;
 	    // TODO add menace in project EBIOS
 	    //cible.addMenace(this);
 	   process();
}


  
 


public void process(){
	 if (this.type.contains("matusg")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("matesp")){
		  disponibilite = false;
		  integrite = false;
		  confidentialite = true;
		  preuve = false;
	  }
	  if (this.type.equals("matdep")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("matdet")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("matmod")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("matpte")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("logusg")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("logesp")){
		  disponibilite = false;
		  integrite = false;
		  confidentialite = true;
		  preuve = false;
	  }
	  if (this.type.equals("logdep")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("logdet")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("logmod")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("logpte")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("rexusg")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("rexesp")){
		  disponibilite = false;
		  integrite = false;
		  confidentialite = true;
		  preuve = false;
	  }
	  if (this.type.equals("rexdep")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("rexdet")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("rexmod")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("rexpte")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = false;
	  }
	  if (this.type.equals("perusg")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("peresp")){
		  disponibilite = false;
		  integrite = false;
		  confidentialite = true;
		  preuve = false;
	  }
	  if (this.type.equals("perdep")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("perdet")){
		  disponibilite = false;
		  integrite = false;
		  confidentialite = false;
		  preuve = false;
	  }
	  if (this.type.equals("permod")){
		  disponibilite = false;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("perpte")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = false;
	  }
	  if (this.type.equals("papusg")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("papesp")){
		  disponibilite = false;
		  integrite = false;
		  confidentialite = true;
		  preuve = false;
	  }
	  if (this.type.equals("papesp")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = false;
		  preuve = true;
	  }
	  if (this.type.equals("papdet")){
		  disponibilite = true;
		  integrite = false;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("locusg")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("locesp")){
		  disponibilite = false;
		  integrite = false;
		  confidentialite = true;
		  preuve = false;
	  }
	  if (this.type.equals("locmod")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("locpte")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
	  if (this.type.equals("locdet")){
		  disponibilite = true;
		  integrite = true;
		  confidentialite = true;
		  preuve = true;
	  }
  }
  
  
  

}
